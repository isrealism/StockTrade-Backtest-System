{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/lib/api.ts"],"sourcesContent":["const API_BASE = process.env.NEXT_PUBLIC_API_URL || \"\";\n\nasync function fetchAPI<T>(path: string, options?: RequestInit): Promise<T> {\n  const res = await fetch(`${API_BASE}${path}`, {\n    ...options,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...options?.headers,\n    },\n  });\n  if (!res.ok) {\n    const error = await res.json().catch(() => ({ detail: res.statusText }));\n    throw new Error(error.detail || \"API request failed\");\n  }\n  return res.json();\n}\n\n// Types\nexport interface SelectorConfig {\n  class: string;\n  alias: string;\n  activate: boolean;\n  params: Record<string, unknown>;\n}\n\nexport interface SellStrategyConfig {\n  description: string;\n  name: string;\n  combination_logic?: string;\n  strategies?: Array<{\n    class: string;\n    params: Record<string, unknown>;\n  }>;\n  class?: string;\n  params?: Record<string, unknown>;\n}\n\nexport interface BacktestPayload {\n  name?: string;\n  start_date: string;\n  end_date: string;\n  initial_capital?: number;\n  max_positions?: number;\n  position_sizing?: string;\n  commission_rate?: number;\n  stamp_tax_rate?: number;\n  slippage_rate?: number;\n  sell_strategy_name?: string;\n  sell_strategy_config?: unknown;\n  buy_config?: unknown;\n  stock_pool?: { type: string; codes?: string[] };\n  lookback_days?: number;\n}\n\nexport interface BacktestSummary {\n  id: string;\n  name: string;\n  status: \"PENDING\" | \"RUNNING\" | \"COMPLETED\" | \"FAILED\" | \"CANCELLED\";\n  progress: number;\n  created_at: string;\n  started_at: string | null;\n  finished_at: string | null;\n  start_date: string;\n  end_date: string;\n  metrics: Record<string, number> | null;\n  error: string | null;\n}\n\nexport interface BacktestDetail extends BacktestSummary {\n  payload: BacktestPayload | null;\n  result: BacktestResult | null;\n  logs: Array<{ ts: string; message: string }>;\n}\n\nexport interface BacktestResult {\n  equity_curve: Array<Record<string, unknown>>;\n  trades: Array<Record<string, unknown>>;\n  analysis: Record<string, unknown>;\n  performance?: Record<string, unknown>;\n  strategy_score: { score: number; components: Record<string, number> };\n  best_trade: Record<string, unknown> | null;\n  best_stock: { code: string; net_pnl: number } | null;\n}\n\nexport interface Template {\n  id: string;\n  name: string;\n  created_at: string;\n  payload: BacktestPayload;\n}\n\nexport interface CandleData {\n  time: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume: number;\n}\n\n// API Functions\nexport async function getConfig() {\n  return fetchAPI<{\n    selectors: SelectorConfig[];\n    sell_strategies: Record<string, SellStrategyConfig>;\n  }>(\"/api/config\");\n}\n\nexport async function listBacktests() {\n  return fetchAPI<{ items: BacktestSummary[] }>(\"/api/backtests\");\n}\n\nexport async function createBacktest(payload: BacktestPayload) {\n  return fetchAPI<{ id: string; status: string }>(\"/api/backtests\", {\n    method: \"POST\",\n    body: JSON.stringify(payload),\n  });\n}\n\nexport async function getBacktest(id: string) {\n  return fetchAPI<BacktestDetail>(`/api/backtests/${id}`);\n}\n\nexport async function cancelBacktest(id: string) {\n  return fetchAPI<{ id: string; status: string }>(\n    `/api/backtests/${id}/cancel`,\n    { method: \"POST\" }\n  );\n}\n\nexport async function listTemplates() {\n  return fetchAPI<{ items: Template[] }>(\"/api/templates\");\n}\n\nexport async function createTemplate(payload: Record<string, unknown>) {\n  return fetchAPI<{ id: string }>(\"/api/templates\", {\n    method: \"POST\",\n    body: JSON.stringify(payload),\n  });\n}\n\nexport async function deleteTemplate(id: string) {\n  return fetchAPI<{ id: string; status: string }>(`/api/templates/${id}`, {\n    method: \"DELETE\",\n  });\n}\n\nexport async function getStockCandles(code: string) {\n  return fetchAPI<{ candles: CandleData[] }>(`/api/stocks/${code}/candles`);\n}\n\nexport async function getRankings(metric = \"score\") {\n  return fetchAPI<{\n    items: Array<{\n      id: string;\n      name: string;\n      created_at: string;\n      metrics: Record<string, number>;\n      rank_value: number;\n    }>;\n  }>(`/api/rankings?metric=${metric}`);\n}\n\nexport async function getBenchmark(name: string, start: string, end: string) {\n  return fetchAPI<{ series: Array<{ date: string; nav: number }> }>(\n    `/api/benchmark?name=${encodeURIComponent(name)}&start=${start}&end=${end}`\n  );\n}\n\nexport async function listCompletedBacktests() {\n  const data = await listBacktests();\n  return {\n    items: data.items.filter((item) => item.status === \"COMPLETED\"),\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAiB;AAAjB,MAAM,WAAW,6DAAmC;AAEpD,eAAe,SAAY,IAAY,EAAE,OAAqB;IAC5D,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C,GAAG,OAAO;QACV,SAAS;YACP,gBAAgB;YAChB,GAAG,SAAS,OAAO;QACrB;IACF;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,QAAQ,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;gBAAE,QAAQ,IAAI,UAAU;YAAC,CAAC;QACtE,MAAM,IAAI,MAAM,MAAM,MAAM,IAAI;IAClC;IACA,OAAO,IAAI,IAAI;AACjB;AAsFO,eAAe;IACpB,OAAO,SAGJ;AACL;AAEO,eAAe;IACpB,OAAO,SAAuC;AAChD;AAEO,eAAe,eAAe,OAAwB;IAC3D,OAAO,SAAyC,kBAAkB;QAChE,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAEO,eAAe,YAAY,EAAU;IAC1C,OAAO,SAAyB,CAAC,eAAe,EAAE,IAAI;AACxD;AAEO,eAAe,eAAe,EAAU;IAC7C,OAAO,SACL,CAAC,eAAe,EAAE,GAAG,OAAO,CAAC,EAC7B;QAAE,QAAQ;IAAO;AAErB;AAEO,eAAe;IACpB,OAAO,SAAgC;AACzC;AAEO,eAAe,eAAe,OAAgC;IACnE,OAAO,SAAyB,kBAAkB;QAChD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAEO,eAAe,eAAe,EAAU;IAC7C,OAAO,SAAyC,CAAC,eAAe,EAAE,IAAI,EAAE;QACtE,QAAQ;IACV;AACF;AAEO,eAAe,gBAAgB,IAAY;IAChD,OAAO,SAAoC,CAAC,YAAY,EAAE,KAAK,QAAQ,CAAC;AAC1E;AAEO,eAAe,YAAY,SAAS,OAAO;IAChD,OAAO,SAQJ,CAAC,qBAAqB,EAAE,QAAQ;AACrC;AAEO,eAAe,aAAa,IAAY,EAAE,KAAa,EAAE,GAAW;IACzE,OAAO,SACL,CAAC,oBAAoB,EAAE,mBAAmB,MAAM,OAAO,EAAE,MAAM,KAAK,EAAE,KAAK;AAE/E;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,OAAO;QACL,OAAO,KAAK,KAAK,CAAC,MAAM,CAAC,CAAC,OAAS,KAAK,MAAM,KAAK;IACrD;AACF"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/lib/hooks.ts"],"sourcesContent":["import useSWR from \"swr\";\nimport {\n  getConfig,\n  listBacktests,\n  getBacktest,\n  getRankings,\n  listTemplates,\n  getStockCandles,\n  getBenchmark,\n  listCompletedBacktests,\n} from \"./api\";\n\nexport function useConfig() {\n  return useSWR(\"config\", getConfig, {\n    revalidateOnFocus: false,\n    dedupingInterval: 60000,\n    onErrorRetry: (error, _key, _config, revalidate, { retryCount }) => {\n      // Only retry 2 times if backend is unavailable\n      if (retryCount >= 2) return;\n      setTimeout(() => revalidate({ retryCount }), 5000);\n    },\n  });\n}\n\nexport function useBacktests() {\n  return useSWR(\"backtests\", listBacktests, {\n    refreshInterval: 3000,\n  });\n}\n\nexport function useBacktest(id: string | null) {\n  return useSWR(id ? `backtest-${id}` : null, () =>\n    id ? getBacktest(id) : null,\n    {\n      refreshInterval: (data) =>\n        data?.status === \"RUNNING\" || data?.status === \"PENDING\" ? 1500 : 0,\n    }\n  );\n}\n\nexport function useRankings(metric: string) {\n  return useSWR(`rankings-${metric}`, () => getRankings(metric));\n}\n\nexport function useTemplates() {\n  return useSWR(\"templates\", listTemplates, {\n    revalidateOnFocus: false,\n  });\n}\n\nexport function useStockCandles(code: string | null) {\n  return useSWR(\n    code ? `candles-${code}` : null,\n    () => (code ? getStockCandles(code) : null),\n    { revalidateOnFocus: false }\n  );\n}\nexport function useBenchmark(\n  name: string | null,\n  start: string,\n  end: string\n) {\n  return useSWR(\n    name ? `benchmark-${name}-${start}-${end}` : null,\n    () => (name ? getBenchmark(name, start, end) : null),\n    { revalidateOnFocus: false }\n  );\n}\n\nexport function useCompletedBacktests() {\n  return useSWR(\"completed-backtests\", listCompletedBacktests, {\n    revalidateOnFocus: false,\n  });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;;;;AAWO,SAAS;;IACd,OAAO,IAAA,4KAAM,EAAC,UAAU,0HAAS,EAAE;QACjC,mBAAmB;QACnB,kBAAkB;QAClB,YAAY;gCAAE,CAAC,OAAO,MAAM,SAAS,YAAY,EAAE,UAAU,EAAE;gBAC7D,+CAA+C;gBAC/C,IAAI,cAAc,GAAG;gBACrB;wCAAW,IAAM,WAAW;4BAAE;wBAAW;uCAAI;YAC/C;;IACF;AACF;GAVgB;;QACP,4KAAM;;;AAWR,SAAS;;IACd,OAAO,IAAA,4KAAM,EAAC,aAAa,8HAAa,EAAE;QACxC,iBAAiB;IACnB;AACF;IAJgB;;QACP,4KAAM;;;AAKR,SAAS,YAAY,EAAiB;;IAC3C,OAAO,IAAA,4KAAM,EAAC,KAAK,CAAC,SAAS,EAAE,IAAI,GAAG;8BAAM,IAC1C,KAAK,IAAA,4HAAW,EAAC,MAAM;6BACvB;QACE,eAAe;kCAAE,CAAC,OAChB,MAAM,WAAW,aAAa,MAAM,WAAW,YAAY,OAAO;;IACtE;AAEJ;IARgB;;QACP,4KAAM;;;AASR,SAAS,YAAY,MAAc;;IACxC,OAAO,IAAA,4KAAM,EAAC,CAAC,SAAS,EAAE,QAAQ;8BAAE,IAAM,IAAA,4HAAW,EAAC;;AACxD;IAFgB;;QACP,4KAAM;;;AAGR,SAAS;;IACd,OAAO,IAAA,4KAAM,EAAC,aAAa,8HAAa,EAAE;QACxC,mBAAmB;IACrB;AACF;IAJgB;;QACP,4KAAM;;;AAKR,SAAS,gBAAgB,IAAmB;;IACjD,OAAO,IAAA,4KAAM,EACX,OAAO,CAAC,QAAQ,EAAE,MAAM,GAAG;kCAC3B,IAAO,OAAO,IAAA,gIAAe,EAAC,QAAQ;iCACtC;QAAE,mBAAmB;IAAM;AAE/B;IANgB;;QACP,4KAAM;;;AAMR,SAAS,aACd,IAAmB,EACnB,KAAa,EACb,GAAW;;IAEX,OAAO,IAAA,4KAAM,EACX,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,KAAK,GAAG;+BAC7C,IAAO,OAAO,IAAA,6HAAY,EAAC,MAAM,OAAO,OAAO;8BAC/C;QAAE,mBAAmB;IAAM;AAE/B;IAVgB;;QAKP,4KAAM;;;AAOR,SAAS;;IACd,OAAO,IAAA,4KAAM,EAAC,uBAAuB,uIAAsB,EAAE;QAC3D,mBAAmB;IACrB;AACF;IAJgB;;QACP,4KAAM"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"rounded-lg border border-border bg-card text-card-foreground\", className)}\n    {...props}\n  />\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex flex-col space-y-1.5 p-5\", className)} {...props} />\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3 ref={ref} className={cn(\"text-base font-semibold leading-none tracking-tight\", className)} {...props} />\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n));\nCardDescription.displayName = \"CardDescription\";\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"px-5 pb-5\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nexport { Card, CardHeader, CardTitle, CardDescription, CardContent };\n"],"names":[],"mappings":";;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,gEAAgE;QAC7E,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAAa,GAAG,KAAK;;;;;;;AAErF,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAG,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,uDAAuD;QAAa,GAAG,KAAK;;;;;;;AAE1G,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAE,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAAa,GAAG,KAAK;;;;;;;AAEnF,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,aAAa;QAAa,GAAG,KAAK;;;;;;;AAEjE,YAAY,WAAW,GAAG"}},
    {"offset": {"line": 334, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/components/ui/badge.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium transition-colors\",\n  {\n    variants: {\n      variant: {\n        default: \"border-transparent bg-primary/15 text-primary\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive: \"border-transparent bg-destructive/15 text-destructive\",\n        outline: \"border-border text-foreground\",\n        success: \"border-transparent bg-[hsl(var(--profit))]/15 text-[hsl(var(--profit))]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants };\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,gGACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,WAAW;YACX,aAAa;YACb,SAAS;YACT,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,6LAAC;QAAI,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE;KAJS"}},
    {"offset": {"line": 383, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/components/ui/select.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as SelectPrimitive from \"@radix-ui/react-select\";\nimport { Check, ChevronDown } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nconst Select = SelectPrimitive.Root;\nconst SelectGroup = SelectPrimitive.Group;\nconst SelectValue = SelectPrimitive.Value;\n\nconst SelectTrigger = React.forwardRef<\n  React.ComponentRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"ml-2 h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n));\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName;\n\nconst SelectContent = React.forwardRef<\n  React.ComponentRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-72 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95\",\n        position === \"popper\" && \"translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n));\nSelectContent.displayName = SelectPrimitive.Content.displayName;\n\nconst SelectItem = React.forwardRef<\n  React.ComponentRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n));\nSelectItem.displayName = SelectPrimitive.Item.displayName;\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectItem,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AACA;AALA;;;;;;AAOA,MAAM,SAAS,6KAAoB;AACnC,MAAM,cAAc,8KAAqB;AACzC,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,MAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,gLAAuB;QACtB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,8SACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,sOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;;AAI7B,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,2KAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACzD,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,KAAK;YACL,WAAW,IAAA,qHAAE,EACX,oKACA,aAAa,YAAY,iBACzB;YAEF,UAAU;YACT,GAAG,KAAK;sBAET,cAAA,6LAAC,iLAAwB;gBACvB,WAAW,IAAA,qHAAE,EACX,OACA,aAAa,YACX;0BAGH;;;;;;;;;;;;;;;;;AAKT,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,6KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6NACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGrB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,6KAAoB,CAAC,WAAW"}},
    {"offset": {"line": 521, "column": 0}, "map": {"version":3,"sources":["file:///Users/pengchuhan/StockTrade-Backtest-System/app/rankings/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRankings } from \"@/lib/hooks\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { cn, formatPercent, formatNumber, formatDate } from \"@/lib/utils\";\nimport { Trophy, Medal, Loader2, BarChart3 } from \"lucide-react\";\nimport Link from \"next/link\";\n\nconst METRIC_OPTIONS = [\n  { value: \"score\", label: \"综合评分\" },\n  { value: \"total_return_pct\", label: \"总收益率\" },\n  { value: \"win_rate_pct\", label: \"胜率\" },\n  { value: \"sharpe_ratio\", label: \"夏普比率\" },\n  { value: \"max_drawdown_pct\", label: \"最大回撤 (升序)\" },\n];\n\nfunction getRankIcon(rank: number) {\n  if (rank === 0) return <Trophy className=\"h-5 w-5 text-chart-3\" />;\n  if (rank === 1) return <Medal className=\"h-5 w-5 text-muted-foreground\" />;\n  if (rank === 2) return <Medal className=\"h-5 w-5 text-chart-3/60\" />;\n  return (\n    <span className=\"flex h-5 w-5 items-center justify-center text-xs font-medium text-muted-foreground\">\n      {rank + 1}\n    </span>\n  );\n}\n\nexport default function RankingsPage() {\n  const [metric, setMetric] = useState(\"score\");\n  const { data, isLoading } = useRankings(metric);\n\n  const items = data?.items || [];\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"mb-6 flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-foreground\">策略排名</h2>\n          <p className=\"mt-1 text-sm text-muted-foreground\">\n            历史回测策略排名对比\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-muted-foreground\">排序指标:</span>\n          <Select value={metric} onValueChange={setMetric}>\n            <SelectTrigger className=\"w-44\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {METRIC_OPTIONS.map((opt) => (\n                <SelectItem key={opt.value} value={opt.value}>\n                  {opt.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      {isLoading && (\n        <div className=\"flex h-40 items-center justify-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        </div>\n      )}\n\n      {!isLoading && items.length === 0 && (\n        <div className=\"flex h-40 flex-col items-center justify-center text-muted-foreground\">\n          <Trophy className=\"mb-2 h-10 w-10\" />\n          <p className=\"text-sm\">暂无排名数据</p>\n          <p className=\"mt-1 text-xs\">完成回测后即可查看策略排名</p>\n        </div>\n      )}\n\n      {!isLoading && items.length > 0 && (\n        <div className=\"space-y-2\">\n          {items.map((item, idx) => {\n            const m = item.metrics || {};\n            return (\n              <Link\n                key={item.id}\n                href={`/results?id=${item.id}`}\n                className=\"block\"\n              >\n                <Card\n                  className={cn(\n                    \"transition-all hover:border-primary/30 hover:bg-primary/5\",\n                    idx === 0 && \"border-chart-3/30 bg-chart-3/5\"\n                  )}\n                >\n                  <CardContent className=\"flex items-center gap-4 py-4\">\n                    {/* Rank */}\n                    <div className=\"flex h-10 w-10 shrink-0 items-center justify-center\">\n                      {getRankIcon(idx)}\n                    </div>\n\n                    {/* Name & Date */}\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"truncate text-sm font-medium text-foreground\">\n                        {item.name}\n                      </p>\n                      <p className=\"mt-0.5 text-xs text-muted-foreground\">\n                        {formatDate(item.created_at)}\n                      </p>\n                    </div>\n\n                    {/* Metrics Grid */}\n                    <div className=\"hidden gap-6 sm:flex\">\n                      <div className=\"text-right\">\n                        <p className=\"text-[10px] text-muted-foreground\">\n                          评分\n                        </p>\n                        <p className=\"font-mono text-sm font-semibold text-foreground\">\n                          {(m.score ?? 0).toFixed(2)}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-[10px] text-muted-foreground\">\n                          收益率\n                        </p>\n                        <p\n                          className={cn(\n                            \"font-mono text-sm font-semibold\",\n                            (m.total_return_pct ?? 0) >= 0\n                              ? \"text-[hsl(var(--profit))]\"\n                              : \"text-[hsl(var(--loss))]\"\n                          )}\n                        >\n                          {formatPercent(m.total_return_pct ?? 0)}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-[10px] text-muted-foreground\">\n                          胜率\n                        </p>\n                        <p className=\"font-mono text-sm text-foreground\">\n                          {formatPercent(m.win_rate_pct ?? 0)}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-[10px] text-muted-foreground\">\n                          夏普\n                        </p>\n                        <p className=\"font-mono text-sm text-foreground\">\n                          {(m.sharpe_ratio ?? 0).toFixed(2)}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-[10px] text-muted-foreground\">\n                          回撤\n                        </p>\n                        <p className=\"font-mono text-sm text-[hsl(var(--loss))]\">\n                          {formatPercent(m.max_drawdown_pct ?? 0)}\n                        </p>\n                      </div>\n                    </div>\n\n                    {/* Rank Value Badge */}\n                    <Badge\n                      variant={idx === 0 ? \"default\" : \"secondary\"}\n                      className=\"shrink-0\"\n                    >\n                      {metric === \"score\"\n                        ? (item.rank_value ?? 0).toFixed(2)\n                        : metric.includes(\"pct\")\n                        ? formatPercent(item.rank_value ?? 0)\n                        : (item.rank_value ?? 0).toFixed(3)}\n                    </Badge>\n                  </CardContent>\n                </Card>\n              </Link>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}